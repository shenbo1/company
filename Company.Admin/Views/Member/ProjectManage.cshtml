
@{
    Layout = null;
}

<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <!--[if lt IE 9]>
    <script type="text/javascript" src="lib/html5shiv.js"></script>
    <script type="text/javascript" src="lib/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/Template/HAdmin/static/h-ui/css/H-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="/Template/HAdmin/static/h-ui.admin/css/H-ui.admin.css" />
    <link rel="stylesheet" type="text/css" href="/Template/HAdmin/lib/Hui-iconfont/1.0.8/iconfont.css" />
    <link rel="stylesheet" type="text/css" href="/Template/HAdmin/static/h-ui.admin/skin/default/skin.css" id="skin" />
    <link rel="stylesheet" type="text/css" href="/Template/HAdmin/static/h-ui.admin/css/style.css" />
    <link href="/Content/css/bootstrap.min14ed.css?v=3.3.6" rel="stylesheet">
    <link href="/Content/css/plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet">
    <!--[if IE 6]>
    <script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
    <script>DD_belatedPNG.fix('*');</script>
    <![endif]-->
    <title>项目名称</title>
</head>
<body>
    @*<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 用户中心 <span class="c-gray en">&gt;</span> 用户管理*@
    <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a></nav>
    <div class="page-container">
        @*<div class="text-c">
                日期范围：
                <input type="text" onfocus="WdatePicker({ maxDate:'#F{$dp.$D(\'datemax\')||\'%y-%M-%d\'}' })" id="datemin" class="input-text Wdate" style="width:120px;">
                -
                <input type="text" onfocus="WdatePicker({ minDate:'#F{$dp.$D(\'datemin\')}',maxDate:'%y-%M-%d' })" id="datemax" class="input-text Wdate" style="width:120px;">
                <input type="text" class="input-text" style="width:250px" placeholder="输入会员名称、电话、邮箱" id="" name="">
                <button type="submit" class="btn btn-success radius" id="" name=""><i class="Hui-iconfont">&#xe665;</i> 搜项目</button>
            </div>*@
        <div class="cl pd-5 bg-1 bk-gray mt-20">
            <span class="l">
                @*<a href="javascript:;" onclick="datadel()" class="btn btn-danger radius">
                    <i class="Hui-iconfont">&#xe6e2;</i> 批量删除</a>*@
                <input type="hidden" id="StatusSel" />
                <a href="javascript:;" onclick="member_add('添加项目','ProjectManageAdd','','510')" class="btn btn-primary radius"><i class="Hui-iconfont">&#xe600;</i> 添加项目</a>
            </span>
            @*<span class="r">共有数据：<strong>88</strong> 条</span>*@
        </div>
        <div class="mt-20">
            <table id="table">
                @*<thead>
                        <tr class="text-c">
                            <th width="25"><input type="checkbox" name="" value=""></th>
                            <th width="80">编号</th>
                            <th width="100">项目名称</th>
                            <th width="40">项目专员</th>
                            <th width="90">联系方式</th>
                            <th width="150">项目状态</th>
                            <th width="150">项目简介</th>
                            <th width="">合作方式</th>
                            <th width="130">启动时间</th>
                            <th width="100">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="text-c">
                            <td><input type="checkbox" value="1" name=""></td>
                            <td>1</td>
                            <td><u style="cursor:pointer" class="text-primary" onclick="member_show('张三','member-show.html','10001','360','400')">张三</u></td>
                            <td>男</td>
                            <td>13000000000</td>
                            <td>admin@mail.com</td>
                            <td class="text-l">北京市 海淀区</td>
                            <td>2014-6-11 11:11:42</td>
                            <td class="td-status"><span class="label label-success radius">已启用</span></td>
                            <td class="td-manage"><a style="text-decoration:none" onClick="member_stop(this,'10001')" href="javascript:;" title="停用"><i class="Hui-iconfont">&#xe631;</i></a> <a title="编辑" href="javascript:;" onclick="member_edit('编辑','member-add.html','4','','510')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6df;</i></a> <a style="text-decoration:none" class="ml-5" onClick="change_password('修改密码','change-password.html','10001','600','270')" href="javascript:;" title="修改密码"><i class="Hui-iconfont">&#xe63f;</i></a> <a title="删除" href="javascript:;" onclick="member_del(this,'1')" class="ml-5" style="text-decoration:none"><i class="Hui-iconfont">&#xe6e2;</i></a></td>
                        </tr>
                    </tbody>*@
            </table>
        </div>
    </div>
    <!--_footer 作为公共模版分离出去-->
    <script type="text/javascript" src="/Template/HAdmin/lib/jquery/1.9.1/jquery.min.js"></script>
    <script src="/Content/js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
    <script src="/Content/js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>
    <script type="text/javascript" src="/Template/HAdmin/lib/layer/2.4/layer.js"></script>
    <script type="text/javascript" src="/Template/HAdmin/static/h-ui/js/H-ui.min.js"></script>
    <script type="text/javascript" src="/Template/HAdmin/static/h-ui.admin/js/H-ui.admin.js"></script>
    <!--/_footer 作为公共模版分离出去-->
    <!--请在下方写此页面业务相关的脚本-->
    <script type="text/javascript" src="/Template/HAdmin/lib/My97DatePicker/4.8/WdatePicker.js"></script>
    <script type="text/javascript" src="/Template/HAdmin/lib/laypage/1.2/laypage.js"></script>
    <script src="~/Content/js/ajax.js"></script>
    <script type="text/javascript">
        $(function () {
            var status = GetQueryString("status");
            if (!isNullOrEmpty(status)) $("#StatusSel").val(status);
	 $('#table').bootstrapTable({
            method: 'POST',
            url: "@Url.Action("ProjectManageList")",
            height: 500,
            pagination: true,
            striped: true,
            pageSize: 10,
            pageNumber: 1,
            pageList: [10, 25, 50, 100, 200],
            queryParams: QueryParams,
            contentType: "application/x-www-form-urlencoded",
            sidePagination: "server",
            sortable: true,
            sortOrder: "asc",
            sortName: "CreateDate",
            //showColumns: true, // 开启自定义列显示功能
            columns: [
                {
                    field: 'FullName',
                    title: '项目名称',
                    align: 'center',
                    valign: 'middle'
                }, {
                    field: 'CusMemberName',
                    title: '客户名称',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        return row.CusCompanyName + '-' + value;
                    }
                }, {
                    field: 'StartTime',
                    title: '项目期望开始时间',
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    formatter: function (value, row, index) {
                        return ChangeDt(value);
                    }
                },
                //    {
                //    field: 'RelStartTime',
                //    title: '项目实际开始时间',
                //    align: 'center',
                //    valign: 'middle',
                //    formatter: function (value, row, index) {
                //        return ChangeDt(value);
                //    }
                //}, {
                //    field: 'RelEndTime',
                //    title: '项目实际开始时间',
                //    align: 'center',
                //    valign: 'middle',
                //    formatter: function (value, row, index) {
                //        return ChangeDt(value);
                //    }
                //},
              {
                    field: 'Infos',
                    title: '项目简介',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        if (value.length > 10) {
                            return '<a onclick="layer.alert(\'' + value + '\')">' + value.substr(0, 10) + '...' + '</a>';
                        }
                        return value;
                    }
                }, {
                    field: 'StatusTxt',
                    title: '状态',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        var sp = '';
                        switch (row.Status) {
                            case 'Start': sp = 'label-primary'; break;
                            case 'Repair': sp = 'label-warning'; break;
                            case 'Finished': sp = 'label-success'; break;
                            case 'End': sp = 'label-danger'; break;
                            case 'Stop': sp = ''; break;
                        }
                        return '<span class="label '+sp+'">' + value + '</span >';
                    },
                },
                {
                    field: 'CreateDate',
                    title: '创建时间',
                    align: 'center',
                    valign: 'middle',
                    sortable: true,
                    formatter: function (value, row, index) {
                        return ChangeDt(value);
                    }
                },
                {
                    field: 'Id',
                    title: '操作',
                    align: 'center',
                    valign: 'middle',
                    formatter: function (value, row, index) {
                        var operate = '';
                        //已完成，已结束，搁置中
                        if (row.Status != 'Finished' && row.Status != 'End' && row.Status !='Stop')
                           operate += '<a  href="/Member/WorkListInfo?pid='+row.Id+'" class="btn btn-info btn-sm gongdan"><i class="fa fa-folder"></i> 工单 </a> ';
                        operate += '<a  class="btn btn-primary btn-sm edit" title="修改"><i class="fa fa-edit"></i> 修改</a> ';
                        operate += '<a  class="btn btn-danger btn-sm delete" title="删除"><i class="fa fa-trash"></i> 删除</a> ';

                        return operate;
                    },
                    events: operateEvents
                }
            ]
        });
});
        function QueryParams(parma) {
            parma["KeyWord"] = $("#KeyWord").val();
            offset = parma["offset"] = parma.offset;
            limit = parma["limit"] = parma.limit;
            parma["StartTime"] = $("#StartTimeFilter").val();
            parma["EndTime"] = $("#EndTimeFilter").val();
            parma["PayWay"] = $("#PayWaySel").val();
            parma["Status"] = $("#StatusSel").val();
            return parma;
        }
          //列事件
    window.operateEvents = {
        'click .edit': function (e, value, row, index) {
            member_add('修改项目-' + row.Name, 'ProjectManageAdd?id=' + row.Id, '', '510');
            //GetInfo(row);
        },
        'click .delete': function (e, value, row, index) {
            layer.confirm('确定删除['+row.Name+']?', {
                    btn: ['确定', '取消'] //按钮
                }, function () {
                    var url = "@Url.Action("ProjectManageDelete")";
                    var Data = {};
                    Data.Id = row.Id;
                    Data.IsDeleted = 1;
                    ajaxGet.post(Data, url, function (data) {
                        if (data.IsSuccess) {
                            layer.msg(data.Message, { icon: 1 });
                            Search();
                        }
                        else {
                            layer.msg(data.Message, { icon: 2 });
                        }
                        // Search();
                    }, function (data) { ExceptionDeal(data); })
                    // layer.msg('的确很重要', { icon: 1 });
                }, function () {

                });
        },
        };
        function Search() {
            $('#table').bootstrapTable("refresh");
        }
/*用户-添加*/
function member_add(title,url,w,h){
	layer_show(title,url,w,h);
}
/*用户-查看*/
function member_show(title,url,id,w,h){
	layer_show(title,url,w,h);
}
    </script>
</body>
</html>